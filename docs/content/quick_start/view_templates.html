#### View Templates <small></small>

In a more generic fashion, we call it **View Template** (or just *View*),
when we refer to that particular kind of content where some elements
in it are bound to fields of a *data model* and, so, that dynamically
change the shown data accordingly to it.

The ```data-ui-field``` attribute, placed on elements of a view template,
is used to bind them to the associated fields in the model.

<small><strong>EXAMPLE - HTML</strong> View Template</small>
<pre data-line="3,6"><code class="language-html">
<!-- View Template - Article item summary -->
<div class="article">
    <h3 data-ui-field="title">
        Article Title
    </h3>
    <div data-ui-field="summary">
        This is the place holder for the article summary.
    </div>
</div>
</code></pre>

<small><strong>DATA MODEL</strong> Example instance</small>
<pre data-line="2,3"><code class="language-js">
model = {
    title: 'Pizza recipe',
    summary: 'Classic homemade pizza recipe, including ...'
}
</code></pre>

<small><strong>RESULT</strong></small>
<div self="size-1of2" class="zuix-example article mdl-shadow--6dp">
<h4 data-ui-field="title">Pizza recipe</h4>
<div data-ui-field="summary">
Classic homemade pizza recipe, including pizza dough and toppings, step-by-step instructions with photos.
</div>
</div>
<style>
.zuix-example.article {
    margin: 12px 36px 24px;
    padding: 0px 12px 12px;
    opacity: 0.6;
}
.zuix-example.article h4 {
    margin-top: 0; margin-bottom: 0;
}
</style>

A *View* can be either implemented in a file, like already described for
[loading content](#Getting_Started--Content_Loading), or as an **inline** View, that is so
placed in the same page rather than on a its own file.

###### Inline View Template

A view is declared inline by adding the ```data-ui-view``` attribute to its root element.
The value of this attribute is meant to be a unique identifier and shall not match the path
of any other view placed in a file or inline in the same page, unless we want to *override* it.

<small><strong>EXAMPLE - </strong> Inline View Template</small>
<pre data-line="2"><code class="language-html">
<!-- definition of a inline view template -->
<span data-ui-view="inline/common/contact_chip"
      class="mdl-chip mdl-chip--contact">
    <img class="mdl-chip__contact" src="site/images/avatar_01.png">
    <span class="mdl-chip__text">Contact Name</span>
</span>
</code></pre>

Inclusion of the above view in the same page

<pre><code class="language-html">
    <div data-ui-include="inline/common/contact_chip"></div>
</code></pre>

<small><strong>RESULT</strong></small>
<div class="content-padding">
<span data-ui-view="inline/common/contact_chip" class="mdl-chip mdl-chip--contact mdl-color--blue mdl-color-text--white mdl-shadow--4dp">
<img data-ui-field="image" class="mdl-chip__contact" src="site/images/avatar_01.png">
<span data-ui-field="name" class="mdl-chip__text">Contact Name</span>
</span>
</div>

##### Data Binding

So, to bind elements of a view template to fields of a given data model, we set the ```data-ui-field``` attribute
on these elements with the name of the model field that we want to bind to.

<a id="Getting_Started--Basic_Binding"></a>
###### Basic Binding

When providing a simple data model like the one described in the previous example,
the model's field is automatically mapped to a certain element's property
depending on the type of the binding element.
For instance, if the element is an ```image```, then the mapped property
will be ```.src```, while for a ```div``` or a ```p``` it will be
the ```.innerHTML``` property.

<small><strong>EXAMPLE - </strong> Inline View Template with ```data-ui-field``` fields.</small>
<pre data-line="4,7"><code class="language-html">
<!-- definition of a inline view template -->
<span data-ui-view="inline/common/contact_chip"
      class="mdl-chip mdl-chip--contact">
    <img  data-ui-field="image"
          class="mdl-chip__contact"
          src="site/images/avatar_01.png">
    <span data-ui-field="name"
          class="mdl-chip__text">Contact Name</span>
</span>
</code></pre>

When including the view template we can specify in its body
a minimal markup declaring same fields as the template,
whose values will be replaced in the template
after its loaded.

<pre data-line="2,3"><code class="language-html">
<div data-ui-include="inline/common/contact_chip">
    <p data-ui-field="name">Mr. Brown</p>
    <p data-ui-field="image">site/images/avatar_02.png</p>
</div>
</code></pre>

<small><strong>RESULT</strong></small>
<div layout="row center-spread" class="mdl-color--grey-50">
<small><strong>before inclusion...</strong></small>
<small><strong>...after template inclusion</strong></small>
</div>
<div layout="row center-spread" class="mdl-color--grey-50 content-padding">
<div class="mdl-color--white">
<p data-ui-field="name">Mr. Brown</p>
<p data-ui-field="image">site/images/avatar_02.png</p>
</div>
<div data-ui-include="inline/common/contact_chip" data-ui-options="main.options.component_no_css" class="mdl-color--white">
<p data-ui-field="name">Mr. Brown</p>
<p data-ui-field="image">site/images/avatar_02.png</p>
</div>
</div>

<p>&nbsp;</p>

So this allows having a valid preview even before
applying the view template (eg. if loading a view from file
and the network is slow).

<style>
.custom-style {
    border: solid 1px teal;
    padding: 4px;
}
</style>
<pre data-line="3,4"><code class="language-html">
<div data-ui-include="inline/common/contact_chip">
    <div class="custom-style">
        <img data-ui-field="image" src="site/images/avatar_01.png">
        <span data-ui-field="name">Mrs. Black</span>
    </div>
</div>
</code></pre>

<small><strong>RESULT</strong></small>
<div layout="row center-spread" class="mdl-color--grey-50">
<small><strong>before inclusion...</strong></small>
<small><strong>...after template inclusion</strong></small>
</div>
<div layout="row center-spread" class="mdl-color--grey-50 content-padding">
<div class="mdl-color--white">
<div class="custom-style">
<img width="48" height="48" data-ui-field="image" src="site/images/avatar_01.png">
<span data-ui-field="name">Mrs. Black</span>
</div>
</div>
<div data-ui-include="inline/common/contact_chip" data-ui-options="main.options.component_no_css" class="mdl-color--white">
<img width="48" height="48" data-ui-field="image" src="site/images/avatar_01.png">
<span data-ui-field="name">Mrs. Black</span>
</div>
</div>


<p>&nbsp;</p>

Another way of using basic binding is by employing
the ```data-bind-model``` attribute

<pre data-line="4,7,11,15"><code class="language-html">
<div layout="row center-spread">
    <!-- Foo Bar chip -->
    <div data-ui-include="inline/common/contact_chip"
         data-bind-model="foo_bar_contact"></div>
    <!-- Jane Doe chip -->
    <div data-ui-include="inline/common/contact_chip"
         data-bind-model="a_random_contact"></div>
</div>
<script>
// example inline data model
foo_bar_contact = {
    image: 'site/images/avatar_02.png',
    name: 'Foo Bar'
};
a_random_contact = {
    image: 'site/images/avatar_01.png',
    name: function(element, field) { element.innerHTML = a_random_name(); }
};
</script>
</code></pre>

<small><strong>RESULT</strong></small>
<div data-ui-view="chip_example_result" layout="row center-spread">
<div data-ui-include="inline/common/contact_chip"
  data-id="0" data-bind-model="chip_adapter"
  data-ui-options="main.options.component_no_css"></div>
<div data-ui-include="inline/common/contact_chip"
  data-id="1" data-bind-model="chip_adapter"
  data-ui-options="main.options.component_no_css"></div>
<script>
var chip_items = {
    "0": { name: 'Foo Bar', image: 'site/images/avatar_02.png'},
    "1": { name: 'Jane Doe', image: 'site/images/avatar_01.png'},
    "2": { name: 'Mikey M.', image: 'site/images/avatar_03.png'}
};
// example model view adapter
var chip_adapter = function(element, field) {
    var id = this.getAttribute('data-id');
    var value = chip_items[id][field];
    switch (field) {
        case 'name':
            element.innerHTML = value;
            break;
        case 'image':
            element.src = value;
            break;
    }
    console.log(this, id, element, field, chip_items[id][field]);
};
</script>
</div>

###### Binding Adapters

Sometimes it might be required to have more control over
how the value of a model's field affects the view.
For this purpose *Binding Adapters* can be used rather than
*[Basic Binding](#Getting_Started--Basic_Binding)*.

A *binding adapter* is a function that gets called when the data model
associated to a view is updated.

    function vm_binding_adapter(element, field) {
        // adapter code ...
    }

where ```element``` is the view element that needs to be updated,
```field``` is the name of the bound field in the model and the
context object **this**, is the view itself.

<small><strong>EXAMPLE - </strong> Using a binding adapter</small>
<pre data-line="3,6,16"><code class="language-html">
<div layout="row center-spread">
    <div data-ui-include="inline/common/contact_chip"
         data-bind-model="chip_adapter"
         data-id="0"></div>
    <div data-ui-include="inline/common/contact_chip"
         data-bind-model="chip_adapter"
         data-id="1"></div>
</div>
<script>
// items list
chip_items = {
    "0": { name: 'Foo Bar', image: 'site/images/avatar_02.png'},
    "1": { name: 'Jane Doe', image: 'site/images/avatar_01.png'}
};
// example adapter
chip_adapter = function(element, field) {
    // the context 'this', is the View itself
    var id = this.getAttribute('data-id');
    // get the value of 'field' in the data model
    var value = chip_items[id][field];
    // use the value to update the bound 'element'
    switch (field) {
        case 'name':
            element.innerHTML = value;
            break;
        case 'image':
            // show place-holder if no image is provided
            if (value == '')
                element.src = 'site/images/chip_placeholder.png';
            else
                element.src = value;
            break;
    }
};
</script>
</code></pre>

<small><strong>RESULT</strong></small>
<div data-ui-include="chip_example_result" data-ui-options="main.options.component_no_css"></div>

<a id="Getting-Started__Behaviors"></a>
##### Behaviors

To describe how a view
will behave upon certain events, like on user interaction events,
a *behavior handler* is used.
A behavior handler is a function that maps events of a view, to
a visible feedback reaction.
For example a view could animate if clicked.

<small><strong>EXAMPLE - </strong> Implmenting behavior handler</small>
<pre data-line="4,22"><code class="language-html">
<div layout="row center-left">
<div data-ui-include="inline/common/contact_chip"
     data-id="2" data-bind-model="chip_adapter"
     data-ui-options="chip_view_options"></div>
</div>
<script>
chip_view_behavior = {
    'mouseover': function () {
        zuix.$(this).css('cursor', 'pointer');
    },
    'mouseout': function () {
        zuix.$(this).css('cursor', 'default')
            .find('img')
            .animateCss('swing');
    },
    'click': function() {
        zuix.$(this).animateCss('pulse')
            .find('img')
            .animateCss('bounce');
    }
};
chip_view_options = {
    css: false,
    behavior: chip_view_behavior
}
</script>
</code></pre>

See the next example for the result.

##### Events

In a similar way to [Behaviors](#Getting-Started__Behaviors), a event
handler can be implemented to map events of a view to the expected action.
For example by clicking a button, a link will open.

<small><strong>EXAMPLE - </strong> Implmenting both behavior handler and event handler</small>
<pre data-line="24"><code class="language-html">
<div layout="row center-left">
<div data-ui-include="inline/common/contact_chip"
     data-id="2" data-bind-model="chip_adapter"
     data-ui-options="chip_view_options"></div>
</div>
<script>
chip_view_behavior = {
    'mouseover': function () {
        zuix.$(this).css('cursor', 'pointer');
    },
    'mouseout': function () {
        zuix.$(this).css('cursor', 'default')
            .find('img')
            .animateCss('swing');
    },
    'click': function() {
        zuix.$(this).animateCss('pulse')
            .find('img')
            .animateCss('bounce');
    }
};
chip_view_options = {
    behavior: chip_view_behavior,
    on: { // inline events mapping
        'click': function() {
            window.open('https://github.com/genielabs/zuix')
        }
    }
}
</script>
</code></pre>

<small><strong>RESULT</strong></small>

<div layout="row center-left" class="content-padding">
<div data-ui-include="inline/common/contact_chip"
     data-id="2" data-bind-model="chip_adapter"
     data-ui-options="chip_view_options"></div>
</div>
<script>
// items list
var chip_view_behavior = {
    'mouseover': function () {
        zuix.$(this).css('cursor', 'pointer');
    },
    'mouseout': function () {
        zuix.$(this).css('cursor', 'default')
            .find('img')
            .animateCss('swing');
    },
    'click': function() {
        zuix.$(this).animateCss('pulse')
            .find('img')
            .animateCss('bounce');
    }
};
var chip_view_options = {
    css: false,
    behavior: chip_view_behavior,
    on: {
        'click': function() {
            setTimeout(function(){
                window.open('https://github.com/genielabs/zuix')
            }, 1000);
        }
    }
};
</script>

<div data-ui-include="content/quick_start/component_management"
     data-ui-options="main.options.content_no_css"
     class="progressive-content-container" ></div>
